{% extends "core/admin_base.html" %}
{% load core_extras %}

{% block title %}Schedule Configuration - CS Dept Platform{% endblock %}

{% block admin_content %}

<div class="section-header">
    <h1 class="section-header__title">Schedule Configuration</h1>
</div>

<div class="admin-config-grid">

    <div class="card admin-config-card">
        <div class="admin-config-card__header">
            <div class="admin-config-card__heading">
                <i class="fa-solid fa-door-open icon-admin"></i>

                <h3>Classrooms</h3>

                <span class="tag tag--danger">{{ classrooms|length }}</span>
            </div>
        </div>

        <form method="post" action="{% url 'add_classroom' %}" class="admin-config-form">

            {% csrf_token %}

            <div class="admin-config-form__fields">
                <input type="text" name="name" placeholder="Code (e.g., CS1)" required class="admin-config-input" />
                <input type="text" name="display_name" placeholder="Display Name (e.g., CS Lab 1)" required class="admin-config-input" />
                <button type="submit" class="btn-compact">
                    <i class="fa-solid fa-plus"></i> Add
                </button>
            </div>
        </form>

        {% if classrooms %}

            <div class="admin-config-chips">

                {% for classroom in classrooms %}

                    <div class="chip">
                        <span class="tag tag--danger">{{ classroom.name }}</span>
                        <span class="chip__text">{{ classroom.display_name }}</span>

                        <form method="post"
                              action="{% url 'delete_classroom' classroom.id %}"
                              style="display:inline">
                            {% csrf_token %}
                            <button type="submit"
                                    onclick="return confirm('Delete {{ classroom.display_name }}?');"
                                    class="action-button action-button--danger">
                                <i class="fa-solid fa-trash"></i>
                            </button>
                        </form>
                    </div>

                {% endfor %}

            </div>

        {% else %}

            <p class="text-secondary text-small italic">No classrooms yet.</p>

        {% endif %}

    </div>

    <div class="card admin-config-card">
        <div class="admin-config-card__header">
            <div class="admin-config-card__heading">
                <i class="fa-solid fa-book icon-success"></i>

                <h3>Subjects</h3>

                <span class="tag tag--success">{{ subjects|length }}</span>
            </div>
        </div>

        <form method="post" action="{% url 'add_subject' %}" class="admin-config-form">

            {% csrf_token %}

            <div class="admin-config-form__fields">
                <input type="text" name="name" placeholder="Code (e.g., CS)" required class="admin-config-input" />
                <input type="text" name="display_name" placeholder="Display Name (e.g., Computer Science)" required class="admin-config-input" />
                <button type="submit" class="btn-compact">
                    <i class="fa-solid fa-plus"></i> Add
                </button>
            </div>
        </form>

        {% if subjects %}

            <div class="admin-config-chips">

                {% for subject in subjects %}

                    <div class="chip">
                        <span class="tag tag--success">{{ subject.name }}</span>
                        <span class="chip__text">{{ subject.display_name }}</span>

                        <form method="post"
                              action="{% url 'delete_subject' subject.id %}"
                              style="display:inline">
                            {% csrf_token %}
                            <button type="submit"
                                    onclick="return confirm('Delete {{ subject.name }}?');"
                                    class="action-button action-button--danger">
                                <i class="fa-solid fa-trash"></i>
                            </button>
                        </form>
                    </div>

                {% endfor %}

            </div>

        {% else %}

            <p class="text-secondary text-small italic">No subjects yet.</p>

        {% endif %}

    </div>

    <div class="card admin-config-card">
        <div class="admin-config-card__header">
            <div class="admin-config-card__heading">
                <i class="fa-solid fa-graduation-cap icon-teacher"></i>

                <h3>Courses</h3>

                <span class="tag tag--info">{{ courses|length }}</span>
            </div>
        </div>

        <form method="post" action="{% url 'add_course' %}" class="admin-config-form">

            {% csrf_token %}

            <div class="admin-config-form__fields">
                <input type="text" name="name" placeholder="Code (e.g., GCSE)" required class="admin-config-input" />
                <input type="text" name="display_name" placeholder="Display Name (e.g., GCSE)" required class="admin-config-input" />
                <button type="submit" class="btn-compact">
                    <i class="fa-solid fa-plus"></i> Add
                </button>
            </div>
        </form>

        {% if courses %}

            <div class="admin-config-chips">

                {% for course in courses %}

                    <div class="chip">
                        <span class="tag tag--info">{{ course.name }}</span>
                        <span class="chip__text">{{ course.display_name }}</span>

                        <form method="post"
                              action="{% url 'delete_course' course.id %}"
                              style="display:inline">
                            {% csrf_token %}
                            <button type="submit"
                                    onclick="return confirm('Delete {{ course.name }}?');"
                                    class="action-button action-button--danger">
                                <i class="fa-solid fa-trash"></i>
                            </button>
                        </form>
                    </div>

                {% endfor %}

            </div>

        {% else %}

            <p class="text-secondary text-small italic">No courses yet.</p>

        {% endif %}

    </div>
</div>

{% endblock %}
